<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BlackMoon Runner</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #000;
  }
  canvas {
    display: block;
    background: linear-gradient(to top, #001, #334);
  }
  #info {
    position: absolute;
    top: 10px;
    left: 10px;
    color: #fff;
    font-family: Arial, sans-serif;
    font-size: 18px;
    z-index: 10;
  }
</style>
</head>
<body>
<div id="info">Puntuación: <span id="score">0</span></div>
<canvas id="gameCanvas"></canvas>
<script>
// ===============================
// CONFIGURACIÓN EDITABLE
// ===============================
const CONFIG = {
  playerImage: 'https://i.imgur.com/COYcE7l.png', // Imagen de la bailarina
  obstacleImage: 'https://i.imgur.com/dvP4Q6M.png', // Obstáculo (aro/tela)
  backgroundColor: '#0a0011', // Fondo general
  gravity: 0.6,     // Gravedad
  jumpForce: -10,   // Fuerza de salto
  speed: 5,         // Velocidad del juego
  obstacleGap: 250, // Distancia entre obstáculos
  musicSrc: 'https://cdn.pixabay.com/download/audio/2022/03/15/audio_ee3ff4f694.mp3?filename=retro-game-music-117056.mp3', // Música
  developerMode: true // Mostrar configuración en consola
};
// ===============================
// FIN CONFIGURACIÓN
// ===============================

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Variables de juego
let player = {
  x: 100,
  y: canvas.height / 2,
  width: 80,
  height: 80,
  vy: 0,
  image: new Image()
};
player.image.src = CONFIG.playerImage;

let obstacles = [];
let score = 0;
let gameOver = false;
let bgColor = CONFIG.backgroundColor;
let obstacleImg = new Image();
obstacleImg.src = CONFIG.obstacleImage;

// Música
const music = new Audio(CONFIG.musicSrc);
music.loop = true;
music.volume = 0.5;
music.play().catch(()=>{}); // Evita bloqueo por autoplay

function createObstacle() {
  const height = 80 + Math.random() * 150;
  const y = canvas.height - height;
  obstacles.push({
    x: canvas.width,
    y,
    width: 60,
    height,
  });
}

function drawPlayer() {
  ctx.drawImage(player.image, player.x, player.y, player.width, player.height);
}

function drawObstacles() {
  obstacles.forEach(o => {
    ctx.drawImage(obstacleImg, o.x, o.y, o.width, o.height);
  });
}

function update() {
  if (gameOver) return;

  ctx.fillStyle = bgColor;
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  player.vy += CONFIG.gravity;
  player.y += player.vy;
  if (player.y + player.height > canvas.height) {
    player.y = canvas.height - player.height;
    player.vy = 0;
  }
  if (player.y < 0) {
    player.y = 0;
    player.vy = 0;
  }

  obstacles.forEach(o => o.x -= CONFIG.speed);
  obstacles = obstacles.filter(o => o.x + o.width > 0);

  if (Math.random() < 0.02) createObstacle();

  obstacles.forEach(o => {
    if (
      player.x < o.x + o.width &&
      player.x + player.width > o.x &&
      player.y + player.height > o.y
    ) {
      gameOver = true;
      music.pause();
      showGameOver();
    }
  });

  drawPlayer();
  drawObstacles();
  score++;
  document.getElementById('score').innerText = score;
  requestAnimationFrame(update);
}

function jump() {
  if (!gameOver) {
    player.vy = CONFIG.jumpForce;
  } else {
    restart();
  }
}

function showGameOver() {
  ctx.fillStyle = 'rgba(0,0,0,0.6)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = '#fff';
  ctx.font = 'bold 48px Arial';
  ctx.textAlign = 'center';
  ctx.fillText('GAME OVER', canvas.width/2, canvas.height/2 - 30);
  ctx.font = '24px Arial';
  ctx.fillText('Haz click o toca para reiniciar', canvas.width/2, canvas.height/2 + 20);
}

function restart() {
  obstacles = [];
  score = 0;
  gameOver = false;
  player.y = canvas.height / 2;
  player.vy = 0;
  music.currentTime = 0;
  music.play();
  update();
}

window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

window.addEventListener('keydown', e => {
  if (e.code === 'Space') jump();
});
canvas.addEventListener('click', jump);

// Inicia el juego
if (CONFIG.developerMode) console.log('CONFIG:', CONFIG);
update();
</script>
</body>
</html>
