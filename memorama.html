<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flappy Aire — BlackMoon Games</title>
  <style>
    :root{--bg-day:#87CEEB;--bg-night:#0b1630;--ground:#2b2b2b}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Arial}
    #game-wrap{display:flex;flex-direction:column;height:100vh}
    header{padding:10px;display:flex;align-items:center;justify-content:space-between;background:linear-gradient(180deg,rgba(0,0,0,0.05),transparent)}
    header .controls{display:flex;gap:8px;align-items:center}
    button{padding:8px 12px;border-radius:8px;border:0;background:#111;color:#fff;cursor:pointer}
    button.secondary{background:#444}
    #canvas-container{flex:1;display:flex;align-items:center;justify-content:center;background:var(--bg-day);transition:background 1s}
    canvas{max-width:100%;height:auto;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.25)}
    footer{display:flex;align-items:center;gap:12px;padding:8px 12px;background:#0f0f10;color:#eee}
    footer img{height:40px}
    .hud{position:absolute;left:14px;top:12px;color:#fff;font-weight:700;text-shadow:0 2px 6px rgba(0,0,0,0.5)}
    .vol-controls{display:flex;gap:6px;align-items:center}
    @media (max-width:600px){button{padding:6px 8px;border-radius:6px;font-size:14px}}
  </style>
</head>
<body>
  <div id="game-wrap">
    <header>
      <div>
        <strong>Aerial Flappy — BlackMoon Games</strong>
      </div>
      <div class="controls">
        <button id="startBtn">Empezar</button>
        <button id="pauseBtn" class="secondary">Pausar</button>
        <div class="vol-controls">
          <button id="volDown">-</button>
          <span id="volLabel">Vol: 100%</span>
          <button id="volUp">+</button>
        </div>
      </div>
    </header>

    <div id="canvas-container">
      <div style="position:relative;max-width:1000px;width:95%">
        <div class="hud" id="scoreHUD">Puntos: 0</div>
        <canvas id="gameCanvas" width="900" height="600"></canvas>
      </div>
    </div>

    <footer>
      <img id="footerImg" src="https://images.unsplash.com/photo-1517817748495-95981a7a1e9d?w=800&q=80" alt="Footer image">
      <div id="footerText">Tu mensaje personalizado aquí — Grupo Black Moon</div>
    </footer>
  </div>

  <script>
  /***************************************************************************
   * CONFIGURACIÓN EDITABLE (cambia estas URLs/textos para personalizar)
   ***************************************************************************/
  const CONFIG = {
    // Personaje (imagen PNG con fondo transparente recomendado)
    character: {
      url: 'https://i.imgur.com/Oj1QZfK.png', // reemplaza por tu imagen del personaje
      width: 72, height: 52
    },

    // Obstáculos: dos arrays (top y bottom) con imágenes. Pueden tener longitudes distintas.
    obstaclesTop: [
      'tela 2.png',
      'https://i.imgur.com/3Z6bQ9K.png'
    ],
    obstaclesBottom: [
      'https://i.imgur.com/6YQw2gP.png',
      'https://i.imgur.com/4pJ1s9a.png'
    ],

    // Escenario: sol, luna, montañas, estrella
    sunUrl: 'sol.png',
    moonUrl: 'luna.png',
    mountainUrl: 'mountain 2.png',
    starUrl: 'https://i.imgur.com/9q5mH0x.png',

    // Música (2 ó 3 pistas). Puedes usar mp3/ogg URLs públicos.
    music: [
      '8.-Soy un Quetzal en el Viento.m4a',
      '6.-Silencio de la Noche.m4a'
    ],

    // Footer: texto e imagen
    footerText: 'Diseñado por Grupo Black Moon — Blackmoon Games',
    footerImage: 'Imagen de WhatsApp 2025-11-02 a las 17.12.14_83e6c797.jpg',

    // gameplay tuning
    gravity: 0.25,
    flapPower: -8.5,
    obstacleGap: 170,
    obstacleWidth: 90,
    obstacleSpacing: 320,
    speed: 0.6
  };
    CONFIG.character.url = "danza-aerea.png"; loadAllAssets();

  /***************************************************************************
   * FIN CONFIG
   ***************************************************************************/

  // Set footer content from config
  document.getElementById('footerText').textContent = CONFIG.footerText;
  document.getElementById('footerImg').src = CONFIG.footerImage;

  // CANVAS & CONTEXT
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  let cw = canvas.width, ch = canvas.height;

  // Responsive canvas scaling
  function fitCanvas(){
    const container = canvas.parentElement.getBoundingClientRect();
    const ratio = cw / ch;
    let w = container.width;
    let h = Math.min(window.innerHeight - 140, w / ratio);
    canvas.style.width = w + 'px';
    canvas.style.height = h + 'px';
  }
  window.addEventListener('resize', fitCanvas);
  fitCanvas();

  // Load images utility
  function loadImage(src){
    return new Promise(res=>{const i=new Image();i.src=src;i.onload=()=>res(i);i.onerror=()=>res(i)});
  }

  // Asset holders
  const ASSETS = {character:null, sun:null, moon:null, mountain:null, star:null, obsTop:[], obsBottom:[]};

  async function loadAllAssets(){
    ASSETS.character = await loadImage(CONFIG.character.url);
    ASSETS.sun = await loadImage(CONFIG.sunUrl);
    ASSETS.moon = await loadImage(CONFIG.moonUrl);
    ASSETS.mountain = await loadImage(CONFIG.mountainUrl);
    ASSETS.star = await loadImage(CONFIG.starUrl);
    for(let u of CONFIG.obstaclesTop) ASSETS.obsTop.push(await loadImage(u));
    for(let u of CONFIG.obstaclesBottom) ASSETS.obsBottom.push(await loadImage(u));
  }

  // Audio
  const audioElements = CONFIG.music.map(src=>{const a=new Audio(src);a.loop=true;return a});
  let currentAudioIndex = 0;
  let masterVolume = 1.0;
  function setVolume(v){masterVolume = Math.max(0,Math.min(1,v)); audioElements.forEach(a=>a.volume=masterVolume); document.getElementById('volLabel').textContent = 'Vol: '+Math.round(masterVolume*100)+'%';}
  setVolume(1.0);

  // Game state
  let bird = {x:160,y:ch/2,vy:0,w:CONFIG.character.width,h:CONFIG.character.height};
  let obstacles = []; // each: {x, topHeight, bottomY, topImg, bottomImg}
  let frames = 0; let score = 0; let running=false; let paused=false; let dayFactor=0; // 0 day -> 1 night

  // Create initial obstacles
  function resetGame(){
    bird.y = ch/2; bird.vy = 0;
    obstacles = [];
    frames = 0; score = 0; running = false; paused=false; dayFactor=0;
    spawnInitialObstacles(); updateHUD();
  }

  function spawnInitialObstacles(){
    let startX = cw + 120;
    for(let i=0;i<4;i++) spawnObstacle(startX + i*CONFIG.obstacleSpacing);
  }

  function spawnObstacle(x){
    // random gap position
    const minTop = 40; const maxTop = ch - CONFIG.obstacleGap - 120;
    const top = Math.floor(minTop + Math.random()*(Math.max(0,maxTop-minTop)));
    // choose images cycling
    const topImg = ASSETS.obsTop[ obstacles.length % ASSETS.obsTop.length ] || null;
    const bottomImg = ASSETS.obsBottom[ obstacles.length % ASSETS.obsBottom.length ] || null;
    obstacles.push({x, topHeight:top, bottomY: top + CONFIG.obstacleGap, topImg, bottomImg});
  }

  function updateHUD(){ document.getElementById('scoreHUD').textContent = 'Puntos: '+score }

  // Input: flap by space/arrow up or click/tap
  function flap(){ bird.vy = CONFIG.flapPower }
  window.addEventListener('keydown', e=>{ if(e.code==='Space' || e.key==='ArrowUp') flap(); });
  canvas.addEventListener('pointerdown', ()=>flap());

  // Start / Pause / Volume buttons
  document.getElementById('startBtn').addEventListener('click', ()=>{
    if(!running){ startGame(); } else { // restart if already running
      resetGame(); startGame();
    }
  });
  document.getElementById('pauseBtn').addEventListener('click', ()=>{
    paused = !paused; document.getElementById('pauseBtn').textContent = paused? 'Reanudar':'Pausar';
    if(!paused) loop();
    audioElements.forEach(a=> paused? a.pause(): a.play());
  });
  document.getElementById('volUp').addEventListener('click', ()=> setVolume(masterVolume + 0.1));
  document.getElementById('volDown').addEventListener('click', ()=> setVolume(masterVolume - 0.1));

  // Game loop
  function startGame(){ if(!running){ running=true; paused=false; audioElements.forEach(a=>a.play()); requestAnimationFrame(loop); }}

  function loop(){ if(!running || paused) return; frames++;
    // physics
    bird.vy += CONFIG.gravity; bird.y += bird.vy;
    // move obstacles
    for(let ob of obstacles) ob.x -= CONFIG.speed;
    // remove offscreen & spawn
    if(obstacles.length && obstacles[0].x < -CONFIG.obstacleWidth){ obstacles.shift(); spawnObstacle(obstacles[obstacles.length-1].x + CONFIG.obstacleSpacing); score+=1; updateHUD(); }
    // collision
    if(bird.y + bird.h > ch - 20){ // floor
      running=false; audioElements.forEach(a=>a.pause());
    }
    if(bird.y < -50) bird.y = -50;
    for(let ob of obstacles){
      // bounding boxes
      const topRect = {x:ob.x, y:0, w:CONFIG.obstacleWidth, h:ob.topHeight};
      const bottomRect = {x:ob.x, y:ob.bottomY, w:CONFIG.obstacleWidth, h: ch - ob.bottomY};
      const birdRect = {x:bird.x, y:bird.y, w:bird.w, h:bird.h};
      if(rectIntersect(birdRect, topRect) || rectIntersect(birdRect, bottomRect)){
        running=false; audioElements.forEach(a=>a.pause());
      }
    }

    // day-night factor based on score / frames (smooth)
    dayFactor = Math.min(1, (score / 10)); // after 10 points it becomes night gradually — puedes cambiar la fórmula

    draw();
    if(running) requestAnimationFrame(loop);
  }

  function rectIntersect(a,b){ return a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y }

  function draw(){
    // background: interpolate between day and night colors
    const dayColor = {r:135,g:206,b:235}; const nightColor = {r:11,g:22,b:48};
    const t = dayFactor; const bg = `rgb(${Math.round(lerp(dayColor.r,nightColor.r,t))},${Math.round(lerp(dayColor.g,nightColor.g,t))},${Math.round(lerp(dayColor.b,nightColor.b,t))})`;
    ctx.fillStyle = bg; ctx.fillRect(0,0,cw,ch);

    // stars (show when t>0.2)
    if(t>0.2){ for(let i=0;i<50;i++){ const sx=(i*37+frames*0.3)%cw; const sy=(i*53)% (ch/2); ctx.globalAlpha = 0.6 * (t); ctx.drawImage(ASSETS.star, sx, sy, 6,6); } ctx.globalAlpha=1 }

    // mountain background (stretched to bottom)
    ctx.drawImage(ASSETS.mountain, 0, ch - 220, cw, 220);

    // sun / moon positions
    const sunX = cw * 0.85; const sunY = ch * (0.15 + 0.2 * Math.sin(frames*0.003));
    const moonX = cw * 0.15; const moonY = ch * (0.2 + 0.2 * Math.cos(frames*0.002));
    // sun visible when t small, moon when t large (crossfade)
    ctx.globalAlpha = 1 - t; ctx.drawImage(ASSETS.sun, sunX, sunY, 72,72);
    ctx.globalAlpha = t; ctx.drawImage(ASSETS.moon, moonX, moonY, 64,64);
    ctx.globalAlpha = 1;

    // draw obstacles
    for(let ob of obstacles){
      // top
      if(ob.topImg) ctx.drawImage(ob.topImg, ob.x, 0, CONFIG.obstacleWidth, ob.topHeight);
      else{ ctx.fillStyle='#2e7'; ctx.fillRect(ob.x,0,CONFIG.obstacleWidth,ob.topHeight); }
      // bottom
      const bh = ch - ob.bottomY;
      if(ob.bottomImg) ctx.drawImage(ob.bottomImg, ob.x, ob.bottomY, CONFIG.obstacleWidth, bh);
      else{ ctx.fillStyle='#2e7'; ctx.fillRect(ob.x,ob.bottomY,CONFIG.obstacleWidth,bh); }
    }

    // draw bird (character)
    if(ASSETS.character) ctx.drawImage(ASSETS.character, bird.x, bird.y, bird.w, bird.h);
    else{ ctx.fillStyle='#ff0'; ctx.fillRect(bird.x,bird.y,bird.w,bird.h); }

    // ground strip
    ctx.fillStyle = '#1f1f1f'; ctx.fillRect(0, ch-20, cw, 20);
  }

  function lerp(a,b,t){return a + (b-a)*t}

  // initial load
  (async ()=>{ await loadAllAssets(); resetGame(); draw(); })();

  // expose some helpers for console or future UI
  window.FLAPPY_AIRE = {CONFIG, resetGame, startGame, pauseGame:()=>{paused=true}, audioElements, setVolume, spawnObstacle};

  </script>
</body>
</html>
