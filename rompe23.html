<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>UNO PREMIUM GLASS</title>

<style>
/* ------------------ ESTILO GENERAL ------------------ */
body {
    margin: 0;
    padding: 0;
    font-family: "Poppins", sans-serif;
    background: linear-gradient(135deg, #1b1b1b, #0f0f0f);
    background-size: cover;
    transition: background 0.8s ease;
    color: #fff;
}

/* ------------------ TÍTULO ------------------ */
h1 {
    text-align: center;
    margin: 25px 0;
    font-size: 48px;
    letter-spacing: 3px;
    font-weight: 700;
    text-shadow: 0 0 15px rgba(255,255,255,0.3);
}

/* ------------------ BOTONES GLASS ------------------ */
.btn {
    padding: 12px 28px;
    margin: 10px;
    border-radius: 25px;
    border: 1px solid rgba(255,255,255,0.25);
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: 0.3s;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}
.btn:hover {
    background: rgba(255,255,255,0.2);
    transform: translateY(-3px);
}

/* ------------------ TABLERO ------------------ */
#gameArea {
    text-align: center;
    padding: 20px;
}

.hand {
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
    margin: 10px 0;
}

/* ------------------ CARTAS GLASS ------------------ */
.card {
    width: 80px;
    height: 120px;
    border-radius: 18px;
    background-size: cover;
    background-position: center;
    border: 2px solid rgba(255,255,255,0.3);
    backdrop-filter: blur(10px);
    position: relative;
    transition: transform 0.2s;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(0,0,0,0.4);
}
.card:hover {
    transform: translateY(-8px) rotate(-2deg);
}
.card span {
    position: absolute;
    bottom: 10px;
    right: 10px;
    font-size: 22px;
    font-weight: bold;
    text-shadow: 0 0 8px rgba(0,0,0,0.5);
}

/* ------------------ PILA ------------------ */
#pile {
    width: 110px;
    height: 160px;
    margin: 20px auto;
    border-radius: 20px;
    border: 3px solid rgba(255,255,255,0.5);
    background-size: cover;
    box-shadow: 0 0 25px rgba(255,255,255,0.4);
}

/* ------------------ FOOTER MULTICOLOR ------------------ */
footer {
    margin-top: 40px;
    padding: 25px;
    background: linear-gradient(90deg, red, yellow, lime, cyan);
    display: flex;
    justify-content: space-around;
    font-weight: bold;
    color: black;
}
footer a {
    color: black;
    text-shadow: none;
}
</style>
</head>
<body>

<h1>UNO PREMIUM GLASS</h1>

<div style="text-align:center;">
    <button class="btn" onclick="startGame()">Iniciar Juego</button>
    <button class="btn" onclick="resetGame()">Reiniciar</button>
    <button class="btn" onclick="changeBackground()">Cambiar Fondo</button>
</div>

<!-- Selector de música -->
<div style="text-align:center; margin:20px;">
    <label>Música: </label>
    <input type="file" id="musicInput" accept="audio/*">
    <button class="btn" onclick="playMusic()">Reproducir</button>
</div>

<audio id="bgMusic"></audio>

<!-- TABLERO -->
<div id="gameArea">
    <div id="pile"></div>

    <h2>Tu mano</h2>
    <div id="playerHand" class="hand"></div>

    <h2>CPU 1</h2>
    <div id="cpu1Hand" class="hand"></div>

    <h2>CPU 2 (si aplica)</h2>
    <div id="cpu2Hand" class="hand"></div>
</div>

<!-- MODO DESARROLLADOR: subir imágenes personalizadas -->
<div style="text-align:center; margin:20px;">
    <h3>Subir imágenes personalizadas de cartas</h3>
    <input type="file" id="imgUpload" multiple accept="image/*">
    <button class="btn" onclick="loadCustomImages()">Cargar Imágenes</button>
</div>

<footer>
    <a href="#">Política</a>
    <a href="#">Contacto</a>
    <a href="#">Términos</a>
</footer>

<script>
/* ---------------------------- CONFIGURACIÓN UNO ---------------------------- */

let colors = ["red", "yellow", "green", "blue"];
let values = ["0","1","2","3","4","5","6","7","8","9","+2","↺","⇆"];
let deck = [];
let pile = [];

let numCPUs = 2;
let hands = {
    player: [],
    cpu1: [],
    cpu2: []
};

let customImages = {};

/* ---------------------------- GENERAR MAZO ---------------------------- */
function generateDeck() {
    deck = [];
    colors.forEach(color => {
        values.forEach(value => {
            deck.push({color, value, id: color+value});
            deck.push({color, value, id: color+value+"_b"});
        });
    });
    deck.sort(() => Math.random() - 0.5);
}

/* ---------------------------- REPARTIR ---------------------------- */
function dealCards() {
    for (let i = 0; i < 7; i++) {
        hands.player.push(deck.pop());
        hands.cpu1.push(deck.pop());
        if (numCPUs === 3) hands.cpu2.push(deck.pop());
    }
    pile.push(deck.pop());
    updateUI();
}

/* ---------------------------- UI ---------------------------- */
function updateUI() {
    renderHand("playerHand", hands.player, true);
    renderHand("cpu1Hand", hands.cpu1, false);
    if (numCPUs === 3) renderHand("cpu2Hand", hands.cpu2, false);

    document.getElementById("pile").style.backgroundImage =
        cardBG(pile.at(-1));
}

function renderHand(id, hand, playable) {
    const zone = document.getElementById(id);
    zone.innerHTML = "";
    hand.forEach((card, i) => {
        const div = document.createElement("div");
        div.className = "card";
        div.style.backgroundImage = cardBG(card);
        div.innerHTML = `<span>${card.value}</span>`;
        if (playable) div.onclick = () => playCard("player", i);
        zone.appendChild(div);
    });
}

/* ---------------------------- FONDO DE CARTA ---------------------------- */
function cardBG(card) {
    if (customImages[card.id]) return `url(${customImages[card.id]})`;
    return `linear-gradient(135deg, ${card.color}, #111)`;
}

/* ---------------------------- VALIDAR ---------------------------- */
function isValid(card) {
    let top = pile.at(-1);
    return card.color === top.color || card.value === top.value;
}

/* ---------------------------- JUGAR ---------------------------- */
function playCard(player, i) {
    let card = hands[player][i];
    if (!isValid(card)) return alert("No puedes jugar esta carta.");

    pile.push(card);
    hands[player].splice(i, 1);

    updateUI();
    setTimeout(cpuTurn, 600);
}

/* ---------------------------- CPU ---------------------------- */
function cpuTurn() {
    const bots = ["cpu1", "cpu2"].slice(0, numCPUs - 1);

    for (let cpu of bots) {
        let played = false;
        for (let i = 0; i < hands[cpu].length; i++) {
            if (isValid(hands[cpu][i])) {
                pile.push(hands[cpu][i]);
                hands[cpu].splice(i, 1);
                played = true;
                break;
            }
        }
        if (!played && deck.length) hands[cpu].push(deck.pop());
    }

    updateUI();
}

/* ---------------------------- INICIO ---------------------------- */
function startGame() {
    generateDeck();
    hands = { player: [], cpu1: [], cpu2: [] };
    pile = [];

    numCPUs = prompt("¿Jugar contra 1 o 2 CPUs?", "2") == "3" ? 3 : 2;

    dealCards();
}

/* ---------------------------- REINICIO ---------------------------- */
function resetGame() {
    location.reload();
}

/* ---------------------------- FONDO ---------------------------- */
function changeBackground() {
    let fondos = [
        "#0f0f0f",
        "radial-gradient(circle, #1b2735, #090a0f)",
        "linear-gradient(135deg, #1e3c72, #2a5298)",
        "linear-gradient(135deg, #3a1c71, #d76d77, #ffaf7b)",
        "linear-gradient(135deg, #000428, #004e92)"
    ];
    document.body.style.background = fondos[Math.floor(Math.random() * fondos.length)];
}

/* ---------------------------- MÚSICA ---------------------------- */
function playMusic() {
    let file = document.getElementById("musicInput").files[0];
    if (!file) return;
    let audio = document.getElementById("bgMusic");
    audio.src = URL.createObjectURL(file);
    audio.play();
}

/* ---------------------------- IMÁGENES PERSONALIZADAS ---------------------------- */
function loadCustomImages() {
    let files = document.getElementById("imgUpload").files;
    for (let f of files) {
        let name = f.name.split(".")[0];
        customImages[name] = URL.createObjectURL(f);
    }
    alert("Imágenes cargadas.");
}
</script>

</body>
</html>

