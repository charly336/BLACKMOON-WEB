<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Aerial Rhythm FIXED</title>
<style>
    body {
        margin: 0;
        background: #0b0b1c;
        font-family: Arial, sans-serif;
        color: #fff;
        text-align: center;
    }

    h1 {
        margin-top: 20px;
    }

    #menu, #gameUI {
        display: none;
    }

    button {
        padding: 15px 25px;
        margin: 10px;
        font-size: 18px;
        border: none;
        background: #7a00ff;
        color: #fff;
        border-radius: 10px;
        cursor: pointer;
    }

    #gameArea {
        width: 90%;
        height: 400px;
        border: 2px solid #ffffff66;
        margin: 20px auto;
        position: relative;
        overflow: hidden;
        background: rgba(255,255,255,0.05);
        border-radius: 15px;
    }

    .note {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        position: absolute;
        top: -80px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 28px;
        font-weight: bold;
        color: #fff;
    }

    .up    { background: #6a00ff; }
    .down  { background: #ff009d; }
    .left  { background: #00d9ff; }
    .right { background: #ffae00; }

    #hitLine {
        width: 100%;
        height: 5px;
        background: #ffffffaa;
        position: absolute;
        bottom: 40px;
    }
</style>
</head>
<body>

<h1>Aerial Rhythm</h1>

<div id="menu">
    <h2>Elige canción</h2>
    <button onclick="startGame('song1.mp3')">Canción 1</button>
    <button onclick="startGame('song2.mp3')">Canción 2</button>
</div>

<div id="gameUI">
    <h3 id="score">Puntos: 0</h3>
    <h3 id="combo">Combo: 0</h3>
    <h3 id="level">Nivel 1</h3>

    <div id="gameArea">
        <div id="hitLine"></div>
    </div>

    <button onclick="pauseGame()">Pausa</button>
    <button onclick="returnMenu()">Menú</button>
</div>

<script>
let score = 0;
let combo = 0;
let level = 1;
let speed = 1300;
let gameInterval;
let isPaused = false;
let music;

function returnMenu() {
    document.getElementById("menu").style.display = "block";
    document.getElementById("gameUI").style.display = "none";
    clearInterval(gameInterval);
    if (music) music.pause();
}

function pauseGame() {
    isPaused = !isPaused;
    if (isPaused) music.pause();
    else music.play();
}

function startGame(songFile) {
    document.getElementById("menu").style.display = "none";
    document.getElementById("gameUI").style.display = "block";

    score = 0;
    combo = 0;
    level = 1;
    speed = 1300;

    updateUI();

    // Cargar música
    music = new Audio(songFile);
    music.loop = true;
    music.volume = 0.7;
    music.play();

    clearInterval(gameInterval);
    gameInterval = setInterval(spawnNote, speed);
}

function updateUI() {
    document.getElementById("score").innerHTML = "Puntos: " + score;
    document.getElementById("combo").innerHTML = "Combo: " + combo;
    document.getElementById("level").innerHTML = "Nivel " + level;
}

function spawnNote() {
    if (isPaused) return;

    const dirs = ["up", "down", "left", "right"];
    let dir = dirs[Math.floor(Math.random()*dirs.length)];

    let n = document.createElement("div");
    n.classList.add("note", dir);

    n.innerText =
        dir === "up" ? "↑" :
        dir === "down" ? "↓" :
        dir === "left" ? "←" : "→";

    n.dataset.direction = dir;

    n.style.left =
        dir === "left" ? "20%" :
        dir === "right" ? "70%" :
        "45%";

    document.getElementById("gameArea").appendChild(n);

    let pos = -80;
    let fall = setInterval(() => {
        if (isPaused) return;
        pos += 3 + level * 0.6;
        n.style.top = pos + "px";

        if (pos > 380) {
            n.remove();
            combo = 0;
            updateUI();
            clearInterval(fall);
        }
    }, 20);
}

document.addEventListener("keydown", e => {
    let dir =
        e.key === "ArrowUp" ? "up" :
        e.key === "ArrowDown" ? "down" :
        e.key === "ArrowLeft" ? "left" :
        e.key === "ArrowRight" ? "right" :
        null;

    if (!dir) return;

    let notes = document.querySelectorAll(".note");

    notes.forEach(n => {
        let t = parseInt(n.style.top);
        if (n.dataset.direction === dir && t > 280 && t < 420) {
            score += 10 + combo;
            combo++;
            if (combo % 10 === 0) {
                level++;
                speed -= 150;
                if (speed < 500) speed = 500;

                clearInterval(gameInterval);
                gameInterval = setInterval(spawnNote, speed);
            }
            updateUI();
            n.remove();
        }
    });
});
</script>

</body>
</html>


