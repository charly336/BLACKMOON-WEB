<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Aerial Rhythm</title>
<style>
    body{
        margin:0;
        background:#050010;
        color:white;
        font-family:Arial;
        overflow:hidden;
    }

    #game{
        width:400px;
        height:600px;
        background:#111;
        margin:20px auto;
        position:relative;
        border:3px solid #8800ff;
        box-shadow:0 0 20px #a300ff;
    }

    /* Columnas donde caen las notas */
    .lane{
        width:100px;
        height:600px;
        border-right:1px solid #333;
        float:left;
        position:relative;
    }

    /* Notas que caen */
    .note{
        width:80px;
        height:20px;
        background:#ff00ff;
        position:absolute;
        left:10px;
        top:-20px;
        border-radius:5px;
        animation:fall 2s linear forwards;
    }

    @keyframes fall{
        from{ top:-40px; }
        to{ top:580px; }
    }

    /* Zona de impacto */
    #hitbar{
        width:400px;
        height:50px;
        background:#222;
        position:absolute;
        bottom:0;
        border-top:3px solid #f0f;
    }

    /* Indicadores de teclas */
    .key{
        width:80px;
        height:40px;
        background:#440044;
        border:2px solid #ff00ff;
        border-radius:10px;
        text-align:center;
        line-height:40px;
        position:absolute;
        bottom:5px;
        color:#fff;
        font-weight:bold;
    }

    #kLeft{ left:10px; }
    #kUp{ left:110px; }
    #kDown{ left:210px; }
    #kRight{ left:310px; }

    #score{
        text-align:center;
        font-size:28px;
        margin-top:10px;
    }
</style>
</head>

<body>

<h1 style="text-align:center;">Aerial Rhythm</h1>
<div id="score">Puntos: 0</div>

<div id="game">
    <div class="lane" id="lane0"></div>
    <div class="lane" id="lane1"></div>
    <div class="lane" id="lane2"></div>
    <div class="lane" id="lane3"></div>

    <div id="hitbar"></div>

    <!-- Botones visuales -->
    <div id="kLeft" class="key">←</div>
    <div id="kUp" class="key">↑</div>
    <div id="kDown" class="key">↓</div>
    <div id="kRight" class="key">→</div>
</div>

<script>
// ----------------------
// MÚSICAS ROTATIVAS
// ----------------------
const songs = [
    "https://cdn.pixabay.com/audio/2022/03/15/audio_2fe0ec1d6b.mp3",
    "https://cdn.pixabay.com/audio/2023/03/19/audio_a1bbef3a8b.mp3",
    "https://cdn.pixabay.com/audio/2022/10/26/audio_3fb5cace35.mp3"
];

let currentSong = 0;
let audio = new Audio(songs[currentSong]);
audio.volume = 0.5;

// Reproduce siguiente canción al terminar
audio.onended = () => {
    currentSong = (currentSong + 1) % songs.length;
    audio = new Audio(songs[currentSong]);
    audio.play();
};

// ----------------------
// NOTAS Y JUEGO
// ----------------------
let score = 0;
const lanes = [0,1,2,3];
const keyMap = { "ArrowLeft":0, "ArrowUp":1, "ArrowDown":2, "ArrowRight":3 };

function spawnNote(){
    let lane = lanes[Math.floor(Math.random()*4)];
    let div = document.createElement("div");
    div.className = "note";
    document.getElementById("lane"+lane).appendChild(div);

    // Cuando termine la animación, eliminar nota
    setTimeout(() => div.remove(), 2100);
}

// Crear notas constantemente
setInterval(spawnNote, 600);

// ----------------------
// DETECCIÓN DE IMPACTO
// ----------------------
document.addEventListener("keydown", e=>{
    if(!(e.key in keyMap)) return;

    let laneNum = keyMap[e.key];
    let lane = document.getElementById("lane"+laneNum);
    let notes = lane.getElementsByClassName("note");

    for(let n of notes){
        let pos = n.getBoundingClientRect().top;

        // Área válida del hitbar
        if(pos > 520 && pos < 580){
            score += 100;
            document.getElementById("score").innerHTML = "Puntos: " + score;
            n.remove();
            break;
        }
    }

    flashKey(laneNum);
});

// Animación del botón
function flashKey(lane){
    const ids = ["kLeft","kUp","kDown","kRight"];
    let b = document.getElementById(ids[lane]);
    b.style.background="#ff00ff";
    setTimeout(()=>{ b.style.background="#440044"; },120);
}

// Iniciar la música
audio.play();

</script>

</body>
</html>



