<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aerial Flap</title>

<style>
    :root {
        --glass: rgba(255, 255, 255, 0.12);
    }

    body {
        margin: 0;
        background: #000;
        overflow: hidden;
        font-family: Arial, sans-serif;
        user-select: none;
    }

    #gameCanvas {
        display: block;
        margin: 0 auto;
        background: linear-gradient(180deg, #000 0%, #1a0033 100%);
        border-bottom: 2px solid #5900ff;
    }

    /* Botón Glass */
    .glassBtn {
        position: absolute;
        padding: 18px 40px;
        font-size: 22px;
        border-radius: 18px;
        background: var(--glass);
        color: #fff;
        border: 1px solid rgba(255,255,255,0.25);
        backdrop-filter: blur(10px);
        cursor: pointer;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        transition: 0.2s;
        text-shadow: 0 0 8px #a020f0;
    }

    .glassBtn:hover {
        background: rgba(255,255,255,0.20);
        transform: translate(-50%, -50%) scale(1.05);
    }

    #score {
        position: fixed;
        top: 15px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 36px;
        font-weight: bold;
        color: #fff;
        text-shadow: 0 0 15px #a020f0;
        z-index: 10;
    }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="score">0</div>

<button id="startBtn" class="glassBtn">Iniciar</button>

<audio id="music" src="music.mp3" loop></audio>

<script>
/* ---------- CANVAS RESPONSIVE ---------- */
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight * 0.9;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

/* ---------- IMÁGENES EDITABLES ---------- */
let birdImg = new Image();
birdImg.src = "bailarina.png"; // Cambia aquí tu personaje

let pillarImg = new Image();
pillarImg.src = "tela.png"; // Cambia aquí tus pilares/telas

/* ---------- VARIABLES DE JUEGO ---------- */
let birdX = 80;
let birdY = 200;
let gravity = 0.4;
let velocity = 0;
let pillars = [];
let playing = false;
let score = 0;

/* ---------- CONTROLES ---------- */
document.getElementById("startBtn").onclick = startGame;
canvas.addEventListener("mousedown", flap);
canvas.addEventListener("touchstart", flap);

/* ---------- FUNCIONES ---------- */

function startGame() {
    playing = true;
    score = 0;
    birdY = canvas.height / 2;
    velocity = 0;
    pillars = [];
    document.getElementById("score").textContent = score;
    document.getElementById("startBtn").style.display = "none";
    document.getElementById("music").play();
    loop();
}

function flap() {
    if (!playing) return;
    velocity = -7;
}

function spawnPillar() {
    let gap = canvas.height * 0.28;
    let topHeight = Math.random() * (canvas.height * 0.45) + 50;

    pillars.push({
        x: canvas.width,
        top: topHeight,
        bottom: topHeight + gap,
        width: canvas.width * 0.18
    });
}

function drawBird() {
    ctx.drawImage(birdImg, birdX, birdY, canvas.width * 0.12, canvas.width * 0.12);
}

function drawPillars() {
    pillars.forEach(p => {
        p.x -= canvas.width * 0.004;

        ctx.drawImage(pillarImg, p.x, 0, p.width, p.top);
        ctx.drawImage(pillarImg, p.x, p.bottom, p.width, canvas.height - p.bottom);
    });
}

function checkCollision() {
    for (let p of pillars) {
        let birdSize = canvas.width * 0.12;

        if (
            birdX + birdSize > p.x &&
            birdX < p.x + p.width &&
            (birdY < p.top || birdY + birdSize > p.bottom)
        ) {
            gameOver();
        }
    }

    if (birdY <= 0 || birdY >= canvas.height - 20) {
        gameOver();
    }
}

function updateScore() {
    pillars.forEach(p => {
        if (p.x + p.width === birdX) {
            score++;
            document.getElementById("score").textContent = score;
        }
    });
}

function gameOver() {
    playing = false;
    document.getElementById("startBtn").textContent = "Reiniciar";
    document.getElementById("startBtn").style.display = "block";
}

/* ---------- LOOP PRINCIPAL ---------- */
function loop() {
    if (!playing) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    velocity += gravity;
    birdY += velocity;

    drawBird();

    if (pillars.length === 0 || pillars[pillars.length - 1].x < canvas.width * 0.6) {
        spawnPillar();
    }

    drawPillars();
    checkCollision();
    updateScore();

    requestAnimationFrame(loop);
}

</script>

</body>
</html>

